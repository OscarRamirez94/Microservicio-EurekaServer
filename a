import com.nimbusds.jwt.SignedJWT;
import org.springframework.stereotype.Service;

@Service
public class JwtMapperService {

    public UserTokenInfo mapToUserTokenInfo(String token) {
        try {
            SignedJWT signedJWT = SignedJWT.parse(token);
            var claims = signedJWT.getJWTClaimsSet();

            return UserTokenInfo.builder()
                    .userId(claims.getSubject())                   // claim "sub"
                    .email(claims.getStringClaim("email"))         // claim custom
                    .roles(claims.getStringListClaim("roles"))     // claim custom
                    .build();

        } catch (Exception e) {
            throw new RuntimeException("Error leyendo JWT", e);
        }
    }
}